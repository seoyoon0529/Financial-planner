<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simple Financial Planner</title>
    <link rel="stylesheet" href="styles.css" />
    <link
      rel="preconnect"
      href="https://fonts.googleapis.com"
    />
    <link
      rel="preconnect"
      href="https://fonts.gstatic.com"
      crossorigin
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.6/dist/chart.umd.min.js"></script>
    <script defer src="app.js"></script>
  </head>
  <body>
    <div class="app-frame">
      <header class="app-header">
        <div>
          <p class="eyebrow">Local-First Finance</p>
          <h1>Simple Financial Planner</h1>
          <p>수입·지출 기록, 분석, 알림까지 한 번에.</p>
        </div>
        <div class="alert-badge" id="alertBadge" aria-live="polite"></div>
      </header>

      <main>
      <section class="dashboard" aria-label="요약 카드">
        <div class="card">
          <p>이번 달 지출</p>
          <h3 id="monthlyExpense">₩0</h3>
        </div>
        <div class="card">
          <p>이번 달 수입</p>
          <h3 id="monthlyIncome">₩0</h3>
        </div>
        <div class="card">
          <p>순자산 흐름</p>
          <h3 id="netFlow">₩0</h3>
        </div>
        <div class="card">
          <p>알림</p>
          <h3 id="alertCount">0건</h3>
        </div>
        <div class="card">
          <p>소비 패턴</p>
          <h3 id="patternType">-</h3>
          <p class="card-detail" id="patternDetail">데이터를 불러오는 중입니다.</p>
        </div>
      </section>

      <section class="panel analytics-card">
        <div class="panel-header">
          <div>
            <p class="muted">카테고리 분석</p>
            <h2>이번 달 파이차트</h2>
          </div>
          <label class="chip chip-light">
            <span>월 선택</span>
            <input type="month" id="analysisMonth" />
          </label>
        </div>
        <div class="analytics-content">
          <div class="analytics-chart">
            <canvas id="categoryChart" height="220"></canvas>
          </div>
          <ul id="categorySummaryList" class="category-summary"></ul>
        </div>
      </section>

      <section class="panel budget-panel">
        <div class="panel-header">
          <div>
            <p class="muted">자동 예산</p>
            <h2>추천 예산 & 진행도</h2>
          </div>
          <button class="ghost" id="refreshBudgetBtn" type="button">다시 계산</button>
        </div>
        <p class="muted small">최근 3개월 지출을 기반으로 월별 예산을 자동 생성합니다.</p>
        <ul id="budgetList" class="budget-list"></ul>
      </section>

      <section class="panel">
        <div class="panel-header">
          <h2>알림 센터</h2>
          <span class="muted" id="alertTimestamp"></span>
        </div>
        <ul id="alertList" class="alert-list"></ul>
      </section>

      <section class="grid two-column">
        <article class="panel">
          <div class="panel-header">
            <h2>거래 입력</h2>
            <button class="ghost" id="cancelEditBtn" type="button">새로 작성</button>
          </div>
          <form id="transactionForm" class="stack gap-md">
            <input type="hidden" id="transactionId" />
            <label>
              날짜
              <input type="date" id="transactionDate" required />
            </label>
            <label>
              구분
              <select id="transactionType" required>
                <option value="expense">지출</option>
                <option value="income">수입</option>
              </select>
            </label>
            <label>
              카테고리
              <select id="transactionCategory" required></select>
            </label>
            <label>
              금액
              <input type="number" id="transactionAmount" min="0" step="100" required />
            </label>
            <label>
              메모
              <textarea id="transactionMemo" rows="2" placeholder="간단히 남겨주세요"></textarea>
            </label>
            <button type="submit" class="primary">저장</button>
          </form>
        </article>

        <article class="panel">
          <div class="panel-header">
            <h2>필터 & 정렬</h2>
            <button class="ghost" id="resetFilterBtn" type="button">초기화</button>
          </div>
          <form id="filterForm" class="stack gap-md">
            <div class="grid two-column">
              <label>
                시작일
                <input type="date" id="filterStart" />
              </label>
              <label>
                종료일
                <input type="date" id="filterEnd" />
              </label>
            </div>
            <div class="grid two-column">
              <label>
                구분
                <select id="filterType">
                  <option value="">전체</option>
                  <option value="expense">지출</option>
                  <option value="income">수입</option>
                </select>
              </label>
              <label>
                카테고리
                <select id="filterCategory">
                  <option value="">전체</option>
                </select>
              </label>
            </div>
            <div class="grid two-column">
              <label>
                최소 금액
                <input type="number" id="filterMin" min="0" />
              </label>
              <label>
                최대 금액
                <input type="number" id="filterMax" min="0" />
              </label>
            </div>
            <label>
              정렬
              <select id="sortBy">
                <option value="date_desc">날짜 최신순</option>
                <option value="date_asc">날짜 오래된순</option>
                <option value="amount_desc">금액 높은순</option>
                <option value="amount_asc">금액 낮은순</option>
                <option value="category">카테고리순</option>
              </select>
            </label>
            <button type="submit" class="secondary">필터 적용</button>
          </form>
        </article>
      </section>

      <section class="panel">
        <div class="panel-header">
          <h2>거래 목록</h2>
          <span id="transactionCount" class="muted"></span>
        </div>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>날짜</th>
                <th>구분</th>
                <th>카테고리</th>
                <th>금액</th>
                <th>메모</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="transactionTableBody"></tbody>
          </table>
        </div>
      </section>

      <section class="grid two-column">
        <article class="panel">
          <div class="panel-header">
            <h2>카테고리 관리</h2>
          </div>
          <form id="categoryForm" class="stack gap-md">
            <input type="hidden" id="categoryId" />
            <label>
              이름
              <input type="text" id="categoryName" required />
            </label>
            <label>
              유형
              <select id="categoryType" required>
                <option value="expense">지출</option>
                <option value="income">수입</option>
              </select>
            </label>
            <button type="submit" class="secondary">카테고리 저장</button>
          </form>
          <ul id="categoryList" class="category-list"></ul>
        </article>

        <article class="panel">
          <div class="panel-header">
            <h2>설정 & 알림</h2>
          </div>
          <form id="settingsForm" class="stack gap-md">
            <label>
              월 지출 한도
              <input type="number" id="monthlyLimit" min="0" placeholder="예: 500000" />
            </label>
            <label>
              카테고리 한도 (카테고리ID:금액, 쉼표 구분)
              <input
                type="text"
                id="categoryLimits"
                placeholder="예: food:200000,transport:100000"
              />
            </label>
            <label>
              고정 지출일 (YYYY-MM-DD)
              <input type="date" id="fixedExpenseDate" />
            </label>
            <textarea
              id="fixedExpenseMemo"
              rows="2"
              placeholder="고정 지출 메모"
            ></textarea>
            <button type="submit" class="secondary">설정 저장</button>
          </form>
        </article>
      </section>

      <section class="panel">
        <div class="panel-header">
          <h2>분석</h2>
        </div>
        <div class="grid two-column">
          <div>
            <h3 class="chart-title">월별 수입/지출</h3>
            <canvas id="monthlyChart" height="200"></canvas>
          </div>
          <div>
            <h3 class="chart-title">최근 7일 지출 추이</h3>
            <canvas id="trendChart" height="200"></canvas>
          </div>
        </div>
      </section>
    </main>

      <footer>
        <p>LocalStorage 기반 · 데이터는 브라우저에만 저장됩니다.</p>
      </footer>
    </div>
  </body>
</html>

